# Logging & Debugging Strategy

> How developers debug Meta-UI generated code and trace issues.

---

## 1. Debug Modes

### 1.1 Generator Debug Mode
```bash
$ meta_gen build --verbose

[INFO] Reading meta/button.meta.dart
[INFO] Parsing ButtonSpec: {label: String, onPressed: VoidCallback?}
[INFO] Loading tokens for: material, cupertino, neo
[DEBUG] Material ButtonTokens: {radius: 24, bgColor: #6200EE}
[INFO] Generating lib/components/app_button.dart
[INFO] âœ“ Generated 1 component in 0.3s
```

### 1.2 Verbosity Levels
```bash
--quiet     # Errors only
--normal    # Info + Errors (default)
--verbose   # Debug + Info + Errors
--trace     # Everything including token resolution
```

---

## 2. Runtime Debug Tools

### 2.1 MetaDebugOverlay
Shows component boundaries and token values on screen.

```dart
// Enable in debug builds
void main() {
  MetaDebug.enabled = kDebugMode;
  MetaDebug.showBoundaries = true;
  MetaDebug.showTokenValues = true;
  runApp(MyApp());
}
```

**Visual Output:**
- Blue dashed border around each Meta component
- Tooltip showing: `AppButton | Material | radius:24`

### 2.2 Token Inspector Widget
```dart
// Add to your debug drawer
MetaTokenInspector(
  onTapComponent: (name, tokens) {
    print('$name: $tokens');
  },
)
```

---

## 3. Source Mapping

### 3.1 Generated Code Comments
```dart
// GENERATED BY META-UI - DO NOT EDIT
// Source: meta/button.meta.dart
// Theme: material
// Generated: 2024-12-16T12:30:00Z

class AppButton extends StatelessWidget {
  // [meta:label] -> spec.label
  final String label;
  
  // [meta:onPressed] -> spec.onPressed
  final VoidCallback? onPressed;
```

### 3.2 Debug Assertions
```dart
class AppButton extends StatelessWidget {
  @override
  Widget build(BuildContext context) {
    assert(() {
      if (label.isEmpty) {
        throw FlutterError('AppButton: label cannot be empty');
      }
      return true;
    }());
    
    return _build(context);
  }
}
```

---

## 4. Console Logging

### 4.1 MetaLogger API
```dart
class MetaLogger {
  static LogLevel level = kDebugMode ? LogLevel.debug : LogLevel.error;
  
  static void debug(String component, String message) {
    if (level.index <= LogLevel.debug.index) {
      print('[META:DEBUG] $component: $message');
    }
  }
  
  static void info(String component, String message) { ... }
  static void warn(String component, String message) { ... }
  static void error(String component, String message, [StackTrace? stack]) { ... }
}
```

### 4.2 Automatic Logging Points
| Event | Log Level | Example |
|-------|-----------|---------|
| Component build | Debug | `[META:DEBUG] AppButton: build()` |
| Token resolved | Trace | `[META:TRACE] AppButton: bgColor -> #6200EE` |
| State change | Debug | `[META:DEBUG] AppButton: state -> pressed` |
| Theme switch | Info | `[META:INFO] Theme changed: material -> neo` |
| Error caught | Error | `[META:ERROR] AppButton: RenderFlex overflow` |

---

## 5. Performance Tracing

### 5.1 Build Time Tracking
```dart
class AppButton extends StatelessWidget {
  @override
  Widget build(BuildContext context) {
    return MetaProfiler.trace('AppButton.build', () {
      return _buildContent(context);
    });
  }
}
```

### 5.2 DevTools Integration
Meta-UI emits custom timeline events visible in Flutter DevTools:
- `meta.button.build` - 0.5ms
- `meta.theme.resolve` - 0.1ms
- `meta.token.lookup` - 0.02ms

---

## 6. Debug Commands

### 6.1 CLI Inspection
```bash
# Show all defined components
$ meta_gen list

Components:
  - AppButton (3 themes)
  - AppBadge (3 themes)
  - AppCard (3 themes)
  - AppInput (3 themes)

# Show token values for a component
$ meta_gen inspect button --theme=neo

ButtonTokens (neo):
  radius: 0
  borderWidth: 3
  bgColor: #FFD700
  textColor: #000000
```

### 6.2 Diff Generated Code
```bash
$ meta_gen diff

Changes since last generation:
  M lib/components/app_button.dart  (+5, -3)
  A lib/components/app_badge.dart   (+45)
```

---

## 7. Troubleshooting Guide

| Symptom | Cause | Solution |
|---------|-------|----------|
| Component shows wrong style | Theme not propagating | Check `MetaTheme` ancestor exists |
| Token value is null | Optional token not defined | Add fallback in token definition |
| Hot reload doesn't update | Static theme mode | Use `--mode=dynamic` |
| "Cannot find component" | Missing generation | Run `meta_gen build` |
| Styles flicker on load | Theme resolving async | Pre-load theme in `main()` |

---

*Document Version: 1.0*
