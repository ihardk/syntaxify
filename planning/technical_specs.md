# Technical Specifications

> Core constraints, CLI specs, and compile-time guarantees.

---

## 1. Core Constraints

### The "No Runtime Magic" Rule

Generated code MUST be:
- Readable Flutter/Compose code
- Standalone (works if generator is deleted)
- No runtime interpretation of AST
- No performance overhead from abstraction

### Generated Code Requirements

- All generated files include header comment with source info
- Files are properly formatted (dart format compliant)
- No dynamic typing in generated code
- Type-safe API surface

---

## 2. CLI Specification

### Commands

| Command                        | Description                     |
| ------------------------------ | ------------------------------- |
| `forge build`                  | Generate from all AST files     |
| `forge build --target=flutter` | Generate for specific target    |
| `forge validate`               | Validate AST without generating |
| `forge clean`                  | Remove all generated files      |
| `forge list`                   | List all defined screens        |

### Flags

| Flag        | Description              |
| ----------- | ------------------------ |
| `--force`   | Overwrite modified files |
| `--verbose` | Detailed output          |
| `--dry-run` | Preview without writing  |

---

## 3. Input/Output Specification

### AST Input Format

```dart
// screens/login.dart
final loginScreen = ScreenDefinition(
  id: 'login',
  layout: ColumnNode(
    children: [
      TextNode(text: 'Welcome Back', style: 'heading'),
      InputNode(label: 'Email', hint: 'you@example.com'),
      ButtonNode(label: 'Login', onPressed: 'login'),
    ],
  ),
);
```

### Generated Output

```dart
// generated/login_screen.dart
// ============================================================
// GENERATED BY Forge v2.0.0
// DO NOT EDIT MANUALLY
// Source: screens/login.dart
// ============================================================

class LoginScreen extends StatelessWidget {
  final LoginController controller;
  
  @override
  Widget build(BuildContext context) {
    return Column(
      children: [
        Text('Welcome Back', style: Theme.of(context).textTheme.headlineMedium),
        TextField(decoration: InputDecoration(labelText: 'Email')),
        ElevatedButton(
          onPressed: controller.login,
          child: Text('Login'),
        ),
      ],
    );
  }
}
```

---

## 4. Validation Rules

| Check                         | When       |
| ----------------------------- | ---------- |
| AST node types valid          | Build time |
| Action identifiers referenced | Build time |
| Cross-platform compatibility  | Build time |
| No forbidden node types       | Build time |

---

## 5. Error Categories

| Code    | Category                    |
| ------- | --------------------------- |
| AST-001 | Unknown node type           |
| AST-002 | Missing required field      |
| AST-003 | Invalid action reference    |
| AST-004 | Platform-specific construct |

---

*Document Version: 3.0 (AST-aligned)*
